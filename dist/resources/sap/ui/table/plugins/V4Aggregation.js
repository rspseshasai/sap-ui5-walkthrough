/*
 * OpenUI5
 * (c) Copyright 2009-2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./PluginBase","../utils/TableUtils"],function(e,t){"use strict";const o=e.extend("sap.ui.table.plugins.V4Aggregation",{metadata:{library:"sap.ui.table",properties:{enabled:{type:"boolean",defaultValue:true},groupHeaderFormatter:{type:"function"}}}});o.findOn=e.findOn;o.prototype.isApplicable=function(t){return e.prototype.isApplicable.apply(this,arguments)&&t.getMetadata().getName()==="sap.ui.table.Table"};o.prototype.onActivate=function(e){n(e.getBinding());t.Grouping.setToDefaultGroupMode(e);t.Hook.register(e,t.Hook.Keys.Table.RowsBound,n);t.Hook.register(e,t.Hook.Keys.Row.UpdateState,i,this);t.Hook.register(e,t.Hook.Keys.Row.Expand,s,this);t.Hook.register(e,t.Hook.Keys.Row.Collapse,r,this)};o.prototype.onDeactivate=function(e){for(const t of e.getColumns()){t._setCellContentVisibilitySettings()}t.Grouping.setToDefaultFlatMode(e);t.Hook.deregister(e,t.Hook.Keys.Table.RowsBound,n);t.Hook.deregister(e,t.Hook.Keys.Row.UpdateState,this.updateRowState,this);t.Hook.deregister(this,t.Hook.Keys.Row.Expand,s,this);t.Hook.deregister(this,t.Hook.Keys.Row.Collapse,r,this)};o.prototype.declareColumnsHavingTotals=function(e){const t=this.getControl()?.getColumns()??[];for(const o of t){const t=e.includes(o);o._setCellContentVisibilitySettings({groupHeader:t,summary:t})}};function n(e){if(!e){return}if(!e.getModel().isA("sap.ui.model.odata.v4.ODataModel")){throw new Error("Model must be sap.ui.model.odata.v4.ODataModel")}}function i(e){const t=e.context.getProperty("@$ui5.node.level");const o=e.context.getProperty("@$ui5.node.isTotal");const n=e.context.getProperty("@$ui5.node.isExpanded")===undefined;const i=t===0&&o;const s=t>0&&!n;const r=!s&&o;e.level=t;e.expandable=s;e.expanded=e.context.getProperty("@$ui5.node.isExpanded")===true;if(i||r){e.type=e.Type.Summary;e.level=t+1}else if(s){e.type=e.Type.GroupHeader}if(s){const o=e.context.getBinding().getAggregation().groupLevels[t-1];const n=this.getGroupHeaderFormatter();if(n){const t=n(e.context,o);if(typeof t!=="string"){throw new Error("The group header title must be a string")}e.title=t}else{e.title=e.context.getProperty(o,true)}}}function s(e){const t=e.getRowBindingContext();if(t){t.expand()}}function r(e){const t=e.getRowBindingContext();if(t){t.collapse()}}return o});
//# sourceMappingURL=V4Aggregation.js.map